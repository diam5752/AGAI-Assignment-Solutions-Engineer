# 1. Ανάλυση Αναγκών

## 1.1 Αναλυτική παρουσίαση των προβλημάτων του πελάτη

Ο πελάτης διαχειρίζεται κρίσιμες πληροφορίες (στοιχεία πελατών, αιτήματα, παραγγελίες, τιμολόγια, επικοινωνία) οι οποίες είναι διάσπαρτες σε διαφορετικές πηγές: HTML φόρμες (online αιτήσεις), αρχεία email (.eml) και HTML τιμολόγια. Σήμερα η επεξεργασία αυτών των δεδομένων γίνεται χειροκίνητα. Οι εργαζόμενοι ανοίγουν κάθε φόρμα, email ή τιμολόγιο, εντοπίζουν οπτικά τα απαραίτητα πεδία (όνομα, στοιχεία επικοινωνίας, ποσά, κωδικούς, ημερομηνίες κ.λπ.) και τα καταχωρούν σε Excel ή Google Sheets. Αυτή η διαδικασία είναι εξαιρετικά χρονοβόρα, επαναλαμβανόμενη και επιρρεπής σε ανθρώπινα λάθη (λάθος ποσά, διπλές ή ελλιπείς εγγραφές, λάθος ΑΦΜ/τηλέφωνα). Παράλληλα, απαιτεί σημαντικό χρόνο εκπαίδευσης και υψηλή συγκέντρωση από το προσωπικό.

Η αποθήκευση και ενημέρωση των δεδομένων γίνεται αποσπασματικά και μη τυποποιημένα, με αποτέλεσμα να μην υπάρχει μία ενιαία, αξιόπιστη “πηγή αλήθειας”. Το ίδιο επιχειρηματικό γεγονός (π.χ. ένα αίτημα πελάτη ή μια πώληση) μπορεί να εμφανίζεται σε διαφορετικές μορφές σε φόρμες, emails και τιμολόγια, με μικρές ή μεγάλες αποκλίσεις. Αυτό δυσκολεύει τον έλεγχο της πληρότητας των στοιχείων και την αντιστοίχιση σχετικών εγγραφών μεταξύ τους (π.χ. αίτηση → προσφορά → τιμολόγιο). Επιπλέον, δυσκολεύει και την παραγωγή συγκεντρωτικών αναφορών για τη διοίκηση. Παράλληλα, δεν υπάρχει εικόνα σε πραγματικό χρόνο για το “πού βρισκόμαστε”: πόσες νέες αιτήσεις ή τιμολόγια υπάρχουν, ποια είναι σε εκκρεμότητα, ποια έχουν ήδη περάσει σε τελικό αρχείο, ποια χρειάζονται διόρθωση.

Επιπλέον, ο πελάτης δεν επιθυμεί ένα πλήρως “μαύρο κουτί” σύστημα αυτοματοποίησης, αλλά μια λύση όπου ο άνθρωπος παραμένει στο κέντρο (human-in-the-loop). Θέλει να μπορεί να ελέγχει τα δεδομένα που έχουν εξαχθεί, να διορθώνει πεδία, να εγκρίνει ή να απορρίπτει εγγραφές πριν αυτές “γράψουν” οριστικά στο τελικό spreadsheet. Στο σημερινό περιβάλλον όμως δεν υπάρχει ενιαία οθόνη/περιβάλλον εργασίας για να βλέπει συγκεντρωμένα όλες τις εγγραφές, δεν υπάρχει δομημένη διαδικασία έγκρισης/ακύρωσης (approve/cancel) και δεν υπάρχει συστηματική καταγραφή ενεργειών (ποιο αρχείο επεξεργάστηκε πότε, ποια πεδία εξαχθήκαν, ποια σφάλματα εμφανίστηκαν). Έτσι, κάθε σφάλμα ή ασυνέπεια εντοπίζεται εκ των υστέρων, συνήθως τυχαία, με επιπλέον κόστος χρόνου και αυξημένο ρίσκο για την επιχείρηση.

Ένα ενιαίο, αυτοματοποιημένο αλλά ελεγχόμενο σύστημα εξαγωγής, ενοποίησης και διαχείρισης δεδομένων είναι επομένως κρίσιμη ανάγκη για να μειωθεί ο χειροκίνητος φόρτος, να περιοριστούν τα λάθη και να αποκτήσει ο πελάτης σαφή, αξιόπιστη και άμεση εικόνα των δεδομένων του.

---

## 1.2 Προτεινόμενες τεχνολογίες και εργαλεία

Η λύση υλοποιείται σε **Python 3.x** για ενιαία επεξεργασία HTML φορμών, emails και HTML τιμολογίων.

* **Εξαγωγή δεδομένων**

  * HTML φόρμες / τιμολόγια: Custom **Regex-based parsers** για στοχευμένη και γρήγορη ανάγνωση πεδίων από τα αρχεία `forms/` και `invoices/`.
  * Emails (.eml): standard βιβλιοθήκη **`email`** για αποστολέα, παραλήπτη, θέμα, ημερομηνία και σώμα, με regex για εξαγωγή στοιχείων επικοινωνίας από το κείμενο.

* **AI Enrichment (Εμπλουτισμός Δεδομένων)**
  Για εγγραφές που προέρχονται από emails ή φόρμες και περιέχουν αδόμητο κείμενο, το σύστημα χρησιμοποιεί τεχνητή νοημοσύνη για να "καταλάβει" το περιεχόμενο.

  Συγκεκριμένα προτείνεται:

  * Χρήση του μοντέλου **GPT-4** της **OpenAI**, μέσω του επίσημου API.
  * Το μοντέλο αναλύει το κείμενο του μηνύματος και εξάγει:
    * **Προτεραιότητα** (High, Medium, Low)
    * **Ενδιαφέρον Υπηρεσίας** (Service Interest)
    * **Σύνοψη Μηνύματος** (Message Summary) σε μία πρόταση.
    * **Ελλείποντα Πεδία** (Missing Fields) που μπορεί να υπάρχουν στο κείμενο αλλά όχι στα μεταδεδομένα.

  Αυτό επιτρέπει την αυτόματη κατηγοριοποίηση αιτημάτων που διαφορετικά θα απαιτούσαν πλήρη ανάγνωση από άνθρωπο.

* **Ενοποίηση, έλεγχος και spreadsheets**

  * **pandas** (εσωτερικά) και custom models για ενοποίηση όλων των πηγών σε ενιαία δομή (`UnifiedRecord`), καθαρισμό και ελέγχους μορφής.
  * Εξαγωγή σε **Google Sheets** μέσω `gspread` / Google Sheets API ή σε τοπικό **Excel (.xlsx)** / **CSV**, ώστε τα εγκεκριμένα δεδομένα να ενημερώνουν αυτόματα τα τελικά αρχεία.

* **Περιβάλλον χρήστη & Human-in-the-loop**

  * **Streamlit** για γρήγορο web dashboard: προβολή όλων των εγγραφών (από φόρμες / emails / τιμολόγια), δυνατότητα άμεσης διόρθωσης τιμών, φίλτρα (π.χ. “Προς έλεγχο”, “Εγκεκριμένα”, “Απορριφθέντα”) και κουμπιά **Έγκριση / Απόρριψη** που πυροδοτούν την αντίστοιχη εγγραφή σε spreadsheet.

* **Καταγραφή ενεργειών και έλεγχος ποιότητας**

  * Χρήση της βιβλιοθήκης **`logging`** της Python για αναλυτικό ιστορικό (ποιο αρχείο διαβάστηκε, τι εξήχθη, ποια σφάλματα προέκυψαν).
  * **Unit tests** (pytest) για parsers και κανόνες ελέγχου.

---

## 1.3 Αρχιτεκτονική λύσης (διάγραμμα ροής)

Η προτεινόμενη αρχιτεκτονική οργανώνεται σε διακριτά στάδια, με καθαρή ροή δεδομένων και ανθρώπινο έλεγχο όπου χρειάζεται:

1. **Είσοδος δεδομένων**

   * Πηγές: HTML φόρμες, emails (.eml), HTML τιμολόγια.
   * Κάθε αρχείο φορτώνεται από τους αντίστοιχους φακέλους (forms, emails, invoices).

2. **Εξαγωγή & AI επεξεργασία**

   * Για **HTML (Forms/Invoices)**: εξαγωγή πεδίων (πελάτης, στοιχεία επικοινωνίας, ποσά, ημερομηνίες κ.λπ.) μέσω regex parsers.
   * Για **emails**: ανάγνωση headers και σώματος.
   * **AI Enrichment**: Εάν λείπουν βασικά στοιχεία (όπως προτεραιότητα ή υπηρεσία) σε emails/forms, καλείται το LLM για να τα συμπληρώσει από τα συμφραζόμενα.

3. **Ενοποίηση & έλεγχος**

   * Όλα τα αποτελέσματα μετατρέπονται σε `UnifiedRecord`.
   * Εφαρμόζονται κανόνες: καθαρισμός ποσών, έλεγχος εγκυρότητας email, normalization.
   * Οι εγγραφές χαρακτηρίζονται ως “pending_review”, “approved” ή “rejected”.

4. **Περιβάλλον χρήστη – Human-in-the-loop**

   * Το web dashboard (Streamlit) εμφανίζει όλες τις εγγραφές.
   * Ο χρήστης μπορεί να δει την πηγή, να διορθώσει τιμές (inline editing) και να επιλέξει **Έγκριση** ή **Απόρριψη**.
   * Παρέχονται metrics σε πραγματικό χρόνο (Total, Approved, Rejected).

5. **Έγκριση & εξαγωγή**

   * Με την **Έγκριση**, η εγγραφή είναι έτοιμη για εξαγωγή.
   * Υποστήριξη εξαγωγής σε **Google Sheets**, **Excel**, και **CSV**.

6. **Καταγραφή & παρακολούθηση**

   * Κάθε βήμα καταγράφεται (logging).

---

# 2. Τεχνική Πρόταση

## 2.1 Λεπτομερής περιγραφή της λύσης

Η λύση υλοποιείται ως ολοκληρωμένη ροή (pipeline) σε Python, με διακριτά επίπεδα: εισαγωγή αρχείων, εξαγωγή/AI εμπλουτισμός, ενοποίηση–έλεγχος, περιβάλλον χρήστη με ανθρώπινη έγκριση και τελική εγγραφή σε spreadsheet.

1. **Εισαγωγή και καταχώριση αρχείων**
   Όλα τα αρχεία (HTML φόρμες, emails `.eml`, HTML τιμολόγια) διαβάζονται από προκαθορισμένους φακέλους (`dummy_data/`).

2. **Εξαγωγή & AI επεξεργασία ανά τύπο πηγής**
   Υλοποιούνται ξεχωριστά modules στο πακέτο `automation.ingestion`:

   * **Φόρμες (HTML)**:
     * Χρήση Regex για εντοπισμό πεδίων φόρμας (ονόματα, email, τηλέφωνα, ποσά, επιλεγμένες υπηρεσίες κ.λπ.).

   * **Emails (.eml)**:
     * Χρήση της βιβλιοθήκης `email` για headers και σώμα.
     * Regex για εντοπισμό στοιχείων επικοινωνίας μέσα στο κείμενο.

   * **Τιμολόγια HTML**:
     * Χρήση Regex και text parsing για εντοπισμό πεδίων (Αριθμός Τιμολογίου, Πελάτης, Ποσά, ΦΠΑ).

   * **AI Enrichment** (στο `automation/processing/enrichment.py`):
     * Για εγγραφές που δεν είναι τιμολόγια (emails/forms), ελέγχεται αν λείπουν κρίσιμα πεδία.
     * Αποστολή στο GPT-4 για εξαγωγή δομημένης πληροφορίας (Priority, Service, Summary).

3. **Ενοποίηση, έλεγχος και κανόνες**
   Όλα τα δεδομένα γίνονται `UnifiedRecord`.
   * Έλεγχοι ποιότητας (missing fields, format checks).
   * Οι εγγραφές φορτώνονται στο session state του Streamlit.

4. **Περιβάλλον χρήστη (Streamlit) – ανθρώπινος έλεγχος**
   Στήνεται ένα web περιβάλλον με Streamlit (`automation/ui/dashboard.py`), το οποίο:
   * Εμφανίζει σε πίνακα όλες τις εγγραφές.
   * Επιτρέπει φιλτράρισμα ανά πηγή και κατάσταση.
   * Επιτρέπει άμεση διόρθωση πεδίων.
   * Προσφέρει κουμπιά **Approve**, **Reject**, **Needs Review**.

5. **Εξαγωγή σε Google Sheets / Excel**
   Υλοποιείται το module `automation/reporting/sinks.py`:
   * Εξαγωγή σε Google Sheets (μέσω Service Account ή Streamlit Secrets).
   * Εξαγωγή σε Excel (.xlsx) και CSV.

6. **Καταγραφή ενεργειών και σφαλμάτων**
   Πλήρες logging system για debugging και audit.

---

## 2.2 Χρονοδιάγραμμα υλοποίησης

1. **Φάση 1 – Προετοιμασία & Ingestion (0,5–1 ημέρα)**
   * Ρύθμιση περιβάλλοντος.
   * Ανάπτυξη Regex Parsers (HTML, Email).

2. **Φάση 2 – AI Enrichment & Processing (1 ημέρα)**
   * Υλοποίηση `enrichment.py` με OpenAI integration.
   * Normalization σε `UnifiedRecord`.

3. **Φάση 3 – Περιβάλλον χρήστη (Streamlit) (1–2 ημέρες)**
   * Δημιουργία dashboard, filters, edit capabilities.

4. **Φάση 4 – Εξαγωγή & Testing (1 ημέρα)**
   * Google Sheets/Excel sinks.
   * Unit tests και verification.

---

## 2.3 Κόστος και ROI analysis

Το κόστος της λύσης χωρίζεται σε:

* **Αρχικό κόστος υλοποίησης** (ανάλυση, ανάπτυξη, δοκιμές).
* **Λειτουργικό κόστος** (χρήση υπηρεσίας AI για enrichment + hosting).

Με τη λύση που προτείνουμε, εκτιμάται ότι περίπου **70%** της εργασίας αυτοματοποιείται.

* **Εξοικονόμηση:** Μείωση χειροκίνητης καταχώρισης, λιγότερα λάθη.
* **Κόστος AI:** Πολύ χαμηλό, καθώς καλείται μόνο για emails/forms που χρειάζονται ανάλυση κειμένου (όχι για κάθε τιμολόγιο).

---

## 2.4 Εναλλακτικές προσεγγίσεις

1. **Καθαρά rule-based λύση χωρίς AI**
   * Δεν θα μπορούσε να κατηγοριοποιήσει αυτόματα τα emails (priority/service).

2. **Πλήρως AI-κεντρική λύση**
   * Θα ήταν πιο ακριβή και πιο αργή. Η υβριδική μας προσέγγιση (Regex για δομημένα, AI για αδόμητα) είναι η βέλτιστη.

---

## 2.5 Δομή Έργου (Project Structure)

```text
automation/
├── core/           # Models (UnifiedRecord), Utils
├── ingestion/      # Extractors (Regex-based for HTML/Email)
├── processing/     # Pipeline, AI Enrichment (OpenAI)
├── reporting/      # Sinks (Google Sheets, Excel, CSV)
└── ui/             # Streamlit Dashboard
```

---

# 3. Παρουσίαση

## Executive Summary

Προτείνεται ένα ελαφρύ, ελεγχόμενο σύστημα αυτοματοποίησης που μειώνει τον χρόνο χειροκίνητης καταχώρισης δεδομένων, με χρήση Python και στοχευμένης Τεχνητής Νοημοσύνης.

**Τι κερδίζει ο πελάτης:**
- Μείωση χειροκίνητης εργασίας.
- Ενιαίο Dashboard ελέγχου.
- Αυτόματη εξαγωγή σε Excel/Google Sheets.
- Έξυπνη ανάλυση emails (Priority/Service) με AI.
